<!DOCTYPE html>
<html  lang="en">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Hands On ML - Tony&#39;s Blog</title>


    <meta name="description" content="Chapter 2 End to End ML ProjectSelected Performance MeasureRoot Measure Square Error$$RMSE(X,h)&#x3D;\sqrt{\frac{1}{m}(h(x^i)-y^i)^2}$$generally the preferred performance measure for regression tasks Mean">
<meta property="og:type" content="article">
<meta property="og:title" content="Hands On ML">
<meta property="og:url" content="http://yoursite.com/blog/2019/05/10/Hands%20On%20ML%20Chap2/index.html">
<meta property="og:site_name" content="Tony&#39;s Blog">
<meta property="og:description" content="Chapter 2 End to End ML ProjectSelected Performance MeasureRoot Measure Square Error$$RMSE(X,h)&#x3D;\sqrt{\frac{1}{m}(h(x^i)-y^i)^2}$$generally the preferred performance measure for regression tasks Mean">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/blog/images/og_image.png">
<meta property="article:published_time" content="2019-05-10T23:48:17.000Z">
<meta property="article:modified_time" content="2020-01-28T05:48:56.168Z">
<meta property="article:author" content="Tony He">
<meta property="article:tag" content="Hands on ML">
<meta property="article:tag" content="Chapter 2">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/blog/images/og_image.png">








<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/blog/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/blog/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/blog/css/style.css">
</head>
<body class="is-2-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/blog/">
            
                <img src="/blog/images/logo.png" alt="Hands On ML" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/blog/">Home</a>
                
                <a class="navbar-item"
                href="/blog/archives">Archives</a>
                
                <a class="navbar-item"
                href="/blog/categories">Categories</a>
                
                <a class="navbar-item"
                href="/blog/projects">Projects</a>
                
                <a class="navbar-item"
                href="/blog/Gallary">Gallery</a>
                
                <a class="navbar-item"
                href="/blog/tags">Tags</a>
                
                <a class="navbar-item"
                href="/blog/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/Maolon">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-10-desktop is-10-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-05-10T23:48:17.000Z">2019-05-10</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/blog/categories/ML/">ML</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    17 minutes read (About 2477 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Hands On ML
            
        </h1>
        <div class="content">
            <h2 id="Chapter-2-End-to-End-ML-Project"><a href="#Chapter-2-End-to-End-ML-Project" class="headerlink" title="Chapter 2 End to End ML Project"></a>Chapter 2 End to End ML Project</h2><h3 id="Selected-Performance-Measure"><a href="#Selected-Performance-Measure" class="headerlink" title="Selected Performance Measure"></a>Selected Performance Measure</h3><p>Root Measure Square Error<br>$$<br>RMSE(X,h)=\sqrt{\frac{1}{m}(h(x^i)-y^i)^2}<br>$$<br>generally the preferred performance measure for regression tasks</p>
<p>Mean Absolute Error<br>$$<br>MAE(X,h) =\frac{1}{m}\displaystyle\sum_{i=1}^{m}|h(x^i)-y^i|<br>$$<br>If there are many outlier districts</p>
<h3 id="Check-assumptions"><a href="#Check-assumptions" class="headerlink" title="Check assumptions"></a>Check assumptions</h3><p>make sure the task is about regression or classification, actually, if a task is to put the exist data into exist category , it is the classification task.</p>
<a id="more"></a> 

<h3 id="Check-dataset"><a href="#Check-dataset" class="headerlink" title="Check dataset"></a>Check dataset</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">housing = load_housing_data()</span><br><span class="line">housing.head() // describe first <span class="number">4</span> datas of the dataset</span><br><span class="line">housing.info()// describe numerical types of the dataset</span><br><span class="line">houding.describe()// describe the distribution of datas</span><br></pre></td></tr></table></figure>



<h3 id="Create-Test-Set"><a href="#Create-Test-Set" class="headerlink" title="Create Test Set"></a>Create Test Set</h3><p>we have to pick randomly for a subset of raw data as the test set to prevent overfitting. However there are some considerations</p>
<ul>
<li>If we purely use random method , next time we run the code , the test set may pick up some samples from learning set.</li>
<li>we have to ensure our test set have cover all kinds of data (near) equally.</li>
</ul>
<p>So the basic way to pick up random data and ensure the same data picked up next time we run the code is using hash function by ourselves , or using library like scikit.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_test_split(housing,test_size=<span class="number">0.2</span>,random_state=<span class="number">42</span>)</span><br></pre></td></tr></table></figure>

<p>and we have to shuffle the test data to fit all the category.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">split = StratifiedShuffleSplit(n_splits=<span class="number">1</span>,test_size=<span class="number">0.2</span>,random_state=<span class="number">42</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Data-Visualization"><a href="#Data-Visualization" class="headerlink" title="Data Visualization"></a>Data Visualization</h3><p>A good way to check the data is visualization for data correlations</p>
<p>we can visual the data in combination way: the Longitude Latitude and population in circle, also with the price</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">housing.plot(kind=<span class="string">"scatter"</span>,x=<span class="string">"longitude"</span>,y=<span class="string">"latitude"</span>,alpha=<span class="number">0.4</span>,</span><br><span class="line">            s=housing[<span class="string">"population"</span>]/<span class="number">100</span>,label=<span class="string">"population"</span>,figsize=(<span class="number">10</span>,<span class="number">7</span>),</span><br><span class="line">             c=<span class="string">"median_house_value"</span>, cmap=plt.get_cmap(<span class="string">"jet"</span>),colorbar=<span class="literal">True</span>,)</span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>



<h3 id="Looking-for-Correlations"><a href="#Looking-for-Correlations" class="headerlink" title="Looking for Correlations"></a>Looking for Correlations</h3><p>we can use </p>
<p><code>housing.corr()</code> looking for <strong>linear</strong> correlation ships between one to several data sets.</p>
<p>in this case, is the median house value to all the sets of data.</p>
<p>The correlations may go completely wrong on <strong>none linear relations</strong> .</p>
<p>Another way to check correlation between attributes is to use <code>scatter_matrix</code> from <code>pandas</code> library </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">housing.plot(kind=<span class="string">"scatter"</span>,x=<span class="string">"median_income"</span>,y=<span class="string">"median_house_value"</span>,alpha=<span class="number">0.1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Try-out-Attribute-Combinations"><a href="#Try-out-Attribute-Combinations" class="headerlink" title="Try out  Attribute Combinations"></a>Try out  Attribute Combinations</h3><p>we can add new attribute to the data in need</p>
<p>lets add rooms per household, bedrooms per room and population per household to data</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">housing[<span class="string">"rooms_per_household"</span>] = housing[<span class="string">"total_rooms"</span>]/housing[<span class="string">"households"</span>]</span><br><span class="line">housing[<span class="string">"bedrooms_per_room"</span>]=housing[<span class="string">"total_bedrooms"</span>]/housing[<span class="string">"total_rooms"</span>]</span><br><span class="line">housing[<span class="string">"population_per_household"</span>]=housing[<span class="string">"population"</span>]/housing[<span class="string">"households"</span>]</span><br></pre></td></tr></table></figure>

<p>and show it using the correlation method again</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">corr_matrix = housing.corr()</span><br><span class="line">corr_matrix[<span class="string">"median_house_value"</span>].sort_values(ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Preparing-Data"><a href="#Preparing-Data" class="headerlink" title="Preparing Data"></a>Preparing Data</h3><p>Instead of doing it manually, we do it using functions.</p>
<p>create a copy of training set from original one.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">housing = strat_train_set.drop(<span class="string">"median_house_value"</span>,axis = <span class="number">1</span>)</span><br><span class="line">housing_labels = strat_train_set[<span class="string">"median_house_value"</span>].copy()</span><br></pre></td></tr></table></figure>

<h3 id="Data-Cleaning"><a href="#Data-Cleaning" class="headerlink" title="Data Cleaning"></a>Data Cleaning</h3><p>most of the machine learning stuff cannot work with missing data, so to duel with this there are three optins</p>
<ul>
<li>get rid of the corresponding districts</li>
<li>get rid of whole attribute</li>
<li>set the value to some value</li>
</ul>
<p>For these options, we can use <code>dropna()</code>, <code>drop()</code> , and <code>fillna()</code> to accomplish task.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">housing.dropna(subset&#x3D;[&quot;total_bedrooms&quot;]) &#x2F;&#x2F;option1</span><br><span class="line">housing.drop(&quot;total_bedrooms&quot;,axis&#x3D;1) &#x2F;&#x2F;option2</span><br><span class="line">median &#x3D; housing[&quot;total_bedrooms&quot;].median() &#x2F;&#x2F;option3</span><br><span class="line">housing[&quot;total_bedrooms&quot;].fillna(median,inplace&#x3D;True)</span><br></pre></td></tr></table></figure>

<p>If we choose to use option 3 this time by using <code>imputer</code> API in <code>scikit</code> . </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> Imputer</span><br><span class="line">imputer = Imputer(strategy=<span class="string">"median"</span>)</span><br></pre></td></tr></table></figure>

<p>now fit the imputer to tanning  data</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">housing_num = housing.drop(<span class="string">"ocean_proximity"</span>,axis=<span class="number">1</span>)</span><br><span class="line">imputer.fit(housing_num)</span><br></pre></td></tr></table></figure>

<p>to check the values are missing we have to check the result of fit in <code>statistics_</code> instance, and we also want to ensure there is no missing values , so also apply imputer to all the numerical attributes.</p>
<p>now we can use the trained imputer to replace the missing vlaues</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = imputer.transform(housing_num)</span><br><span class="line">housing_tr = pd.DataFrame(x,columns=housing_num.columns)</span><br></pre></td></tr></table></figure>

<p>The result can put into pandas data frame</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">housing_tr &#x3D; pd.DataFrame(x,columns&#x3D;housing_num.columns)</span><br></pre></td></tr></table></figure>



<h3 id="Handling-Text-and-Categorical-Attributes"><a href="#Handling-Text-and-Categorical-Attributes" class="headerlink" title="Handling Text and Categorical Attributes"></a>Handling Text and Categorical Attributes</h3><p>for none numerical attribute we have two tries , either abandoned it or change it from text to numerical type.</p>
<p>A basic encoding method is to use pandas <code>factorize()</code> method to mapping text to number</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">housing_cat_encoded,housing_categories = housing_cat.factorize()</span><br><span class="line">housing_cat_encoded[:<span class="number">10</span>]</span><br><span class="line">&gt;&gt;&gt;&gt;array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>], dtype=int64)</span><br></pre></td></tr></table></figure>

<p>and we also can check the catagories</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">housing_categories</span><br><span class="line">&gt;&gt;Index([<span class="string">'&lt;1H OCEAN'</span>, <span class="string">'NEAR OCEAN'</span>, <span class="string">'INLAND'</span>, <span class="string">'NEAR BAY'</span>, <span class="string">'ISLAND'</span>], dtype=<span class="string">'object'</span>)</span><br></pre></td></tr></table></figure>

<p>and we can notice that the encoding is not so robust as the <code>&lt;1H OCEAN</code> is encode into <code>1</code> and <code>Near OCEAN</code> is also encode into <code>1</code> , and we can tell they are not similar.</p>
<p>Scikit provide another solution for this</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> CategoricalEncoder <span class="comment"># or get from notebook</span></span><br><span class="line">cat_encoder = CategoricalEncoder()</span><br><span class="line">housing_cat_reshaped = housing_cat.values.reshape(<span class="number">-1</span>,<span class="number">1</span>)</span><br><span class="line">housing_cat_1hot = cat_encoder.fit_transform(housing_cat_reshaped)</span><br><span class="line">housing_cat_1hot</span><br></pre></td></tr></table></figure>

<p>this will transform from text to 2-D array in one shot.</p>
<h3 id="Custom-Transformers"><a href="#Custom-Transformers" class="headerlink" title="Custom Transformers"></a>Custom Transformers</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.base <span class="keyword">import</span> BaseEstimator, TransformerMixin</span><br><span class="line"></span><br><span class="line"><span class="comment"># get the right column indices: safer than hard-coding indices 3, 4, 5, 6</span></span><br><span class="line">rooms_ix, bedrooms_ix, population_ix, household_ix = [</span><br><span class="line">    list(housing.columns).index(col)</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> (<span class="string">"total_rooms"</span>, <span class="string">"total_bedrooms"</span>, <span class="string">"population"</span>, <span class="string">"households"</span>)]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CombinedAttributesAdder</span><span class="params">(BaseEstimator, TransformerMixin)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, add_bedrooms_per_room = True)</span>:</span> <span class="comment"># no *args or **kwargs</span></span><br><span class="line">        self.add_bedrooms_per_room = add_bedrooms_per_room</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, X, y=None)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self  <span class="comment"># nothing else to do</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(self, X, y=None)</span>:</span></span><br><span class="line">        rooms_per_household = X[:, rooms_ix] / X[:, household_ix]</span><br><span class="line">        population_per_household = X[:, population_ix] / X[:, household_ix]</span><br><span class="line">        <span class="keyword">if</span> self.add_bedrooms_per_room:</span><br><span class="line">            bedrooms_per_room = X[:, bedrooms_ix] / X[:, rooms_ix]</span><br><span class="line">            <span class="keyword">return</span> np.c_[X, rooms_per_household, population_per_household,</span><br><span class="line">                         bedrooms_per_room]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> np.c_[X, rooms_per_household, population_per_household]</span><br><span class="line"></span><br><span class="line">attr_adder = CombinedAttributesAdder(add_bedrooms_per_room=<span class="literal">False</span>)</span><br><span class="line">housing_extra_attribs = attr_adder.transform(housing.values)</span><br></pre></td></tr></table></figure>



<h3 id="Feature-Scaling"><a href="#Feature-Scaling" class="headerlink" title="Feature Scaling"></a>Feature Scaling</h3><p>the ML algorithm didn’t perform well on different scale of the numerical , for e.g. the number of rooms ranges from about 6 to 39320 while the median income only in range of 0 to 15. There are two ways to solve this situation:</p>
<ol>
<li>min-max scaling </li>
<li>standarlizaiton</li>
</ol>
<p>min-max scaling or normalization: shift all the scale into ranging from 0 to 1. we do this by subtracting the min value and dividing by the max minus the min.</p>
<p>standardization: first subtract the mean value, and divides by the variance so the resulting distribution has unit variance.</p>
<h3 id="Transformation-Pipelines"><a href="#Transformation-Pipelines" class="headerlink" title="Transformation Pipelines"></a>Transformation Pipelines</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line">num_pipeline = Pipeline([</span><br><span class="line">        (<span class="string">'imputer'</span>, Imputer(strategy=<span class="string">"median"</span>)),</span><br><span class="line">        (<span class="string">'attribs_adder'</span>, CombinedAttributesAdder()),</span><br><span class="line">        (<span class="string">'std_scaler'</span>, StandardScaler()),</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">housing_num_tr = num_pipeline.fit_transform(housing_num)</span><br></pre></td></tr></table></figure>



<h3 id="Select-and-Train-model"><a href="#Select-and-Train-model" class="headerlink" title="Select and Train model"></a>Select and Train model</h3><h4 id="Training-and-Evaluating-on-the-training-set"><a href="#Training-and-Evaluating-on-the-training-set" class="headerlink" title="Training and Evaluating on the training set"></a>Training and Evaluating on the training set</h4><p>now we can implemented model after all manipulating to our data.  Lets try the Linear regression model.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">lin_reg = LinearRegression()</span><br><span class="line">lin_reg.fit(housing_prepared,housing_labels)</span><br></pre></td></tr></table></figure>

<p>and show the results</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">some_data = housing.iloc[:<span class="number">5</span>]</span><br><span class="line">some_labels = housing_labels.iloc[:<span class="number">5</span>]</span><br><span class="line">some_data_prepared = full_pipeline.transform(some_data)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Predictions:"</span>, lin_reg.predict(some_data_prepared))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Predictions: [<span class="number">210644.60459286</span> <span class="number">317768.80697211</span> <span class="number">210956.43331178</span>  <span class="number">59218.98886849</span></span><br><span class="line"> <span class="number">189747.55849879</span>]</span><br></pre></td></tr></table></figure>

<p>let’s check the root mean square error</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"></span><br><span class="line">housing_predictions = lin_reg.predict(housing_prepared)</span><br><span class="line">lin_mse = mean_squared_error(housing_labels, housing_predictions)</span><br><span class="line">lin_rmse = np.sqrt(lin_mse)</span><br><span class="line">lin_rmse</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">68628.19819848922</span></span><br></pre></td></tr></table></figure>

<p>not very good result using the prediction compare to our original result</p>
<p>let’s try Decision Tree Regressor model</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"></span><br><span class="line">tree_reg = DecisionTreeRegressor(random_state=<span class="number">42</span>)</span><br><span class="line">tree_reg.fit(housing_prepared, housing_labels)</span><br></pre></td></tr></table></figure>

<p>and check the RMSE result</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">housing_predictions = tree_reg.predict(housing_prepared)</span><br><span class="line">tree_mse = mean_squared_error(housing_labels, housing_predictions)</span><br><span class="line">tree_rmse = np.sqrt(tree_mse)</span><br><span class="line">tree_rmse</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0.0</span></span><br></pre></td></tr></table></figure>

<p>0.0? Apparently we are overfitting our model, this is not a good result.</p>
<h4 id="Better-Evaluation-Using-Cross-Validation"><a href="#Better-Evaluation-Using-Cross-Validation" class="headerlink" title="Better Evaluation Using Cross-Validation"></a>Better Evaluation Using Cross-Validation</h4><p>But how could we confirmed 0.0 is due to overfitting instead this model is very “good” ? In order to distinguish this situation , we should use Cross validation method to our training set.</p>
<p>This method will again , separate our training set randomly into test set and compare to the prediction and result.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"></span><br><span class="line">scores = cross_val_score(tree_reg, housing_prepared, housing_labels,</span><br><span class="line">                         scoring=<span class="string">"neg_mean_squared_error"</span>, cv=<span class="number">10</span>)</span><br><span class="line">tree_rmse_scores = np.sqrt(-scores)</span><br></pre></td></tr></table></figure>

<p>let’s try Decision tree again</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def display_scores(scores):</span><br><span class="line">    print(&quot;Scores:&quot;, scores)</span><br><span class="line">    print(&quot;Mean:&quot;, scores.mean())</span><br><span class="line">    print(&quot;Standard deviation:&quot;, scores.std())</span><br><span class="line"></span><br><span class="line">display_scores(tree_rmse_scores)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Scores: [70194.33680785 66855.16363941 72432.58244769 70758.73896782</span><br><span class="line"> 71115.88230639 75585.14172901 70262.86139133 70273.6325285</span><br><span class="line"> 75366.87952553 71231.65726027]</span><br><span class="line">Mean: 71407.68766037929</span><br><span class="line">Standard deviation: 2439.4345041191004</span><br></pre></td></tr></table></figure>

<p>now we can see the RMSE is not so good now, we can confirmed the previous result is due to overfitting.</p>
<p>Let’s try another model Random Forest Regressor</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line"></span><br><span class="line">forest_reg = RandomForestRegressor(n_estimators=<span class="number">10</span>, random_state=<span class="number">42</span>)</span><br><span class="line">forest_reg.fit(housing_prepared, housing_labels)</span><br></pre></td></tr></table></figure>

<p>check is RMSE</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">housing_predictions = forest_reg.predict(housing_prepared)</span><br><span class="line">forest_mse = mean_squared_error(housing_labels, housing_predictions)</span><br><span class="line">forest_rmse = np.sqrt(forest_mse)</span><br><span class="line">forest_rmse</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">21933.31414779769</span></span><br></pre></td></tr></table></figure>

<p>and also using the cross validation method</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"></span><br><span class="line">forest_scores = cross_val_score(forest_reg, housing_prepared, housing_labels,</span><br><span class="line">                                scoring=<span class="string">"neg_mean_squared_error"</span>, cv=<span class="number">10</span>)</span><br><span class="line">forest_rmse_scores = np.sqrt(-forest_scores)</span><br><span class="line">display_scores(forest_rmse_scores)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Scores: [<span class="number">51646.44545909</span> <span class="number">48940.60114882</span> <span class="number">53050.86323649</span> <span class="number">54408.98730149</span></span><br><span class="line"> <span class="number">50922.14870785</span> <span class="number">56482.50703987</span> <span class="number">51864.52025526</span> <span class="number">49760.85037653</span></span><br><span class="line"> <span class="number">55434.21627933</span> <span class="number">53326.10093303</span>]</span><br><span class="line">Mean: <span class="number">52583.72407377466</span></span><br><span class="line">Standard deviation: <span class="number">2298.353351147122</span></span><br></pre></td></tr></table></figure>

<p>now we can see the MEAN is much better than the Decision Tree’s MEAN.</p>
<h3 id="Fine-Tune-Your-Model"><a href="#Fine-Tune-Your-Model" class="headerlink" title="Fine-Tune Your Model"></a>Fine-Tune Your Model</h3><h4 id="Grid-Search"><a href="#Grid-Search" class="headerlink" title="Grid Search"></a>Grid Search</h4><p>There are may be many combinations of hyperparameter if we search manually thus we can use the API provide by scikit </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</span><br><span class="line"></span><br><span class="line">param_grid = [</span><br><span class="line">    <span class="comment"># try 12 (3×4) combinations of hyperparameters</span></span><br><span class="line">    &#123;<span class="string">'n_estimators'</span>: [<span class="number">3</span>, <span class="number">10</span>, <span class="number">30</span>], <span class="string">'max_features'</span>: [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>]&#125;,</span><br><span class="line">    <span class="comment"># then try 6 (2×3) combinations with bootstrap set as False</span></span><br><span class="line">    &#123;<span class="string">'bootstrap'</span>: [<span class="literal">False</span>], <span class="string">'n_estimators'</span>: [<span class="number">3</span>, <span class="number">10</span>], <span class="string">'max_features'</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]&#125;,</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">forest_reg = RandomForestRegressor(random_state=<span class="number">42</span>)</span><br><span class="line"><span class="comment"># train across 5 folds, that's a total of (12+6)*5=90 rounds of training </span></span><br><span class="line">grid_search = GridSearchCV(forest_reg, param_grid, cv=<span class="number">5</span>,</span><br><span class="line">                           scoring=<span class="string">'neg_mean_squared_error'</span>, return_train_score=<span class="literal">True</span>)</span><br><span class="line">grid_search.fit(housing_prepared, housing_labels)</span><br></pre></td></tr></table></figure>

<p>and show the result</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grid_search.best_params_</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#39;max_features&#39;: 8, &#39;n_estimators&#39;: 30&#125;</span><br></pre></td></tr></table></figure>

<p>we can also let it show the best estimator directly</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RandomForestRegressor(bootstrap=<span class="literal">True</span>, criterion=<span class="string">'mse'</span>, max_depth=<span class="literal">None</span>,</span><br><span class="line">           max_features=<span class="number">8</span>, max_leaf_nodes=<span class="literal">None</span>, min_impurity_decrease=<span class="number">0.0</span>,</span><br><span class="line">           min_impurity_split=<span class="literal">None</span>, min_samples_leaf=<span class="number">1</span>,</span><br><span class="line">           min_samples_split=<span class="number">2</span>, min_weight_fraction_leaf=<span class="number">0.0</span>,</span><br><span class="line">           n_estimators=<span class="number">30</span>, n_jobs=<span class="literal">None</span>, oob_score=<span class="literal">False</span>, random_state=<span class="number">42</span>,</span><br><span class="line">           verbose=<span class="number">0</span>, warm_start=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<p>Also we can let it show the all results</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cvres = grid_search.cv_results_</span><br><span class="line"><span class="keyword">for</span> mean_score, params <span class="keyword">in</span> zip(cvres[<span class="string">"mean_test_score"</span>], cvres[<span class="string">"params"</span>]):</span><br><span class="line">    print(np.sqrt(-mean_score), params)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">63669.05791727153</span> &#123;<span class="string">'max_features'</span>: <span class="number">2</span>, <span class="string">'n_estimators'</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="number">55627.16171305252</span> &#123;<span class="string">'max_features'</span>: <span class="number">2</span>, <span class="string">'n_estimators'</span>: <span class="number">10</span>&#125;</span><br><span class="line"><span class="number">53384.57867637289</span> &#123;<span class="string">'max_features'</span>: <span class="number">2</span>, <span class="string">'n_estimators'</span>: <span class="number">30</span>&#125;</span><br><span class="line"><span class="number">60965.99185930139</span> &#123;<span class="string">'max_features'</span>: <span class="number">4</span>, <span class="string">'n_estimators'</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="number">52740.98248528835</span> &#123;<span class="string">'max_features'</span>: <span class="number">4</span>, <span class="string">'n_estimators'</span>: <span class="number">10</span>&#125;</span><br><span class="line"><span class="number">50377.344409590376</span> &#123;<span class="string">'max_features'</span>: <span class="number">4</span>, <span class="string">'n_estimators'</span>: <span class="number">30</span>&#125;</span><br><span class="line"><span class="number">58663.84733372485</span> &#123;<span class="string">'max_features'</span>: <span class="number">6</span>, <span class="string">'n_estimators'</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="number">52006.15355973719</span> &#123;<span class="string">'max_features'</span>: <span class="number">6</span>, <span class="string">'n_estimators'</span>: <span class="number">10</span>&#125;</span><br><span class="line"><span class="number">50146.465964159885</span> &#123;<span class="string">'max_features'</span>: <span class="number">6</span>, <span class="string">'n_estimators'</span>: <span class="number">30</span>&#125;</span><br><span class="line"><span class="number">57869.25504027614</span> &#123;<span class="string">'max_features'</span>: <span class="number">8</span>, <span class="string">'n_estimators'</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="number">51711.09443660957</span> &#123;<span class="string">'max_features'</span>: <span class="number">8</span>, <span class="string">'n_estimators'</span>: <span class="number">10</span>&#125;</span><br><span class="line"><span class="number">49682.25345942335</span> &#123;<span class="string">'max_features'</span>: <span class="number">8</span>, <span class="string">'n_estimators'</span>: <span class="number">30</span>&#125;</span><br><span class="line"><span class="number">62895.088889905004</span> &#123;<span class="string">'bootstrap'</span>: <span class="literal">False</span>, <span class="string">'max_features'</span>: <span class="number">2</span>, <span class="string">'n_estimators'</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="number">54658.14484390074</span> &#123;<span class="string">'bootstrap'</span>: <span class="literal">False</span>, <span class="string">'max_features'</span>: <span class="number">2</span>, <span class="string">'n_estimators'</span>: <span class="number">10</span>&#125;</span><br><span class="line"><span class="number">59470.399594730654</span> &#123;<span class="string">'bootstrap'</span>: <span class="literal">False</span>, <span class="string">'max_features'</span>: <span class="number">3</span>, <span class="string">'n_estimators'</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="number">52725.01091081235</span> &#123;<span class="string">'bootstrap'</span>: <span class="literal">False</span>, <span class="string">'max_features'</span>: <span class="number">3</span>, <span class="string">'n_estimators'</span>: <span class="number">10</span>&#125;</span><br><span class="line"><span class="number">57490.612956065226</span> &#123;<span class="string">'bootstrap'</span>: <span class="literal">False</span>, <span class="string">'max_features'</span>: <span class="number">4</span>, <span class="string">'n_estimators'</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="number">51009.51445842374</span> &#123;<span class="string">'bootstrap'</span>: <span class="literal">False</span>, <span class="string">'max_features'</span>: <span class="number">4</span>, <span class="string">'n_estimators'</span>: <span class="number">10</span>&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Randomized-Search"><a href="#Randomized-Search" class="headerlink" title="Randomized Search"></a>Randomized Search</h4><p>if we are dueling with only a few parmeters then Grid Search is fine, otherwise we may consider using randomized search  with <strong>RandomizedSearchCV</strong>  </p>
<p>with this method you can</p>
<ul>
<li>control the iteration numbers</li>
<li>more combination of parameters</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> RandomizedSearchCV</span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">param_distribs = &#123;</span><br><span class="line">        <span class="string">'n_estimators'</span>: randint(low=<span class="number">1</span>, high=<span class="number">200</span>),</span><br><span class="line">        <span class="string">'max_features'</span>: randint(low=<span class="number">1</span>, high=<span class="number">8</span>),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">forest_reg = RandomForestRegressor(random_state=<span class="number">42</span>)</span><br><span class="line">rnd_search = RandomizedSearchCV(forest_reg, param_distributions=param_distribs,</span><br><span class="line">                                n_iter=<span class="number">10</span>, cv=<span class="number">5</span>, scoring=<span class="string">'neg_mean_squared_error'</span>, random_state=<span class="number">42</span>)</span><br><span class="line">rnd_search.fit(housing_prepared, housing_labels)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">RandomizedSearchCV(cv=<span class="number">5</span>, error_score=<span class="string">'raise-deprecating'</span>,</span><br><span class="line">          estimator=RandomForestRegressor(bootstrap=<span class="literal">True</span>, criterion=<span class="string">'mse'</span>, max_depth=<span class="literal">None</span>,</span><br><span class="line">           max_features=<span class="string">'auto'</span>, max_leaf_nodes=<span class="literal">None</span>,</span><br><span class="line">           min_impurity_decrease=<span class="number">0.0</span>, min_impurity_split=<span class="literal">None</span>,</span><br><span class="line">           min_samples_leaf=<span class="number">1</span>, min_samples_split=<span class="number">2</span>,</span><br><span class="line">           min_weight_fraction_leaf=<span class="number">0.0</span>, n_estimators=<span class="string">'warn'</span>, n_jobs=<span class="literal">None</span>,</span><br><span class="line">           oob_score=<span class="literal">False</span>, random_state=<span class="number">42</span>, verbose=<span class="number">0</span>, warm_start=<span class="literal">False</span>),</span><br><span class="line">          fit_params=<span class="literal">None</span>, iid=<span class="string">'warn'</span>, n_iter=<span class="number">10</span>, n_jobs=<span class="literal">None</span>,</span><br><span class="line">          param_distributions=&#123;<span class="string">'n_estimators'</span>: &lt;scipy.stats._distn_infrastructure.rv_frozen object at <span class="number">0x000002055C0CFA58</span>&gt;, <span class="string">'max_features'</span>: &lt;scipy.stats._distn_infrastructure.rv_frozen object at <span class="number">0x000002057D30FCF8</span>&gt;&#125;,</span><br><span class="line">          pre_dispatch=<span class="string">'2*n_jobs'</span>, random_state=<span class="number">42</span>, refit=<span class="literal">True</span>,</span><br><span class="line">          return_train_score=<span class="string">'warn'</span>, scoring=<span class="string">'neg_mean_squared_error'</span>,</span><br><span class="line">          verbose=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cvres = rnd_search.cv_results_</span><br><span class="line"><span class="keyword">for</span> mean_score, params <span class="keyword">in</span> zip(cvres[<span class="string">"mean_test_score"</span>], cvres[<span class="string">"params"</span>]):</span><br><span class="line">    print(np.sqrt(-mean_score), params)</span><br></pre></td></tr></table></figure>

<p>and shows the results</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cvres = rnd_search.cv_results_</span><br><span class="line"><span class="keyword">for</span> mean_score, params <span class="keyword">in</span> zip(cvres[<span class="string">"mean_test_score"</span>], cvres[<span class="string">"params"</span>]):</span><br><span class="line">    print(np.sqrt(-mean_score), params)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">49150.657232934034</span> &#123;<span class="string">'max_features'</span>: <span class="number">7</span>, <span class="string">'n_estimators'</span>: <span class="number">180</span>&#125;</span><br><span class="line"><span class="number">51389.85295710133</span> &#123;<span class="string">'max_features'</span>: <span class="number">5</span>, <span class="string">'n_estimators'</span>: <span class="number">15</span>&#125;</span><br><span class="line"><span class="number">50796.12045980556</span> &#123;<span class="string">'max_features'</span>: <span class="number">3</span>, <span class="string">'n_estimators'</span>: <span class="number">72</span>&#125;</span><br><span class="line"><span class="number">50835.09932039744</span> &#123;<span class="string">'max_features'</span>: <span class="number">5</span>, <span class="string">'n_estimators'</span>: <span class="number">21</span>&#125;</span><br><span class="line"><span class="number">49280.90117886215</span> &#123;<span class="string">'max_features'</span>: <span class="number">7</span>, <span class="string">'n_estimators'</span>: <span class="number">122</span>&#125;</span><br><span class="line"><span class="number">50774.86679035961</span> &#123;<span class="string">'max_features'</span>: <span class="number">3</span>, <span class="string">'n_estimators'</span>: <span class="number">75</span>&#125;</span><br><span class="line"><span class="number">50682.75001237282</span> &#123;<span class="string">'max_features'</span>: <span class="number">3</span>, <span class="string">'n_estimators'</span>: <span class="number">88</span>&#125;</span><br><span class="line"><span class="number">49608.94061293652</span> &#123;<span class="string">'max_features'</span>: <span class="number">5</span>, <span class="string">'n_estimators'</span>: <span class="number">100</span>&#125;</span><br><span class="line"><span class="number">50473.57642831875</span> &#123;<span class="string">'max_features'</span>: <span class="number">3</span>, <span class="string">'n_estimators'</span>: <span class="number">150</span>&#125;</span><br><span class="line"><span class="number">64429.763804893395</span> &#123;<span class="string">'max_features'</span>: <span class="number">5</span>, <span class="string">'n_estimators'</span>: <span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Ensemble-Methods"><a href="#Ensemble-Methods" class="headerlink" title="Ensemble Methods"></a>Ensemble Methods</h4><p>Another way to fine tune system is to combine the models that perform best, because compare to individual model this will usually perform better.</p>
<h4 id="Analyze-the-best-Models-and-Their-Errors"><a href="#Analyze-the-best-Models-and-Their-Errors" class="headerlink" title="Analyze the best Models and Their Errors"></a>Analyze the best Models and Their Errors</h4><p>For random Forest Regressor can indicate the relative importance of each attribute for making accurate predictions.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">feature_importances = grid_search.best_estimator_.feature_importances_</span><br><span class="line">feature_importances</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">array([7.33442355e-02, 6.29090705e-02, 4.11437985e-02, 1.46726854e-02,</span><br><span class="line">       1.41064835e-02, 1.48742809e-02, 1.42575993e-02, 3.66158981e-01,</span><br><span class="line">       5.64191792e-02, 1.08792957e-01, 5.33510773e-02, 1.03114883e-02,</span><br><span class="line">       1.64780994e-01, 6.02803867e-05, 1.96041560e-03, 2.85647464e-03])</span><br></pre></td></tr></table></figure>

<p>and display these importance scores next to their attribute names:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">extra_attribs = [<span class="string">"rooms_per_hhold"</span>, <span class="string">"pop_per_hhold"</span>, <span class="string">"bedrooms_per_room"</span>]</span><br><span class="line"><span class="comment">#cat_encoder = cat_pipeline.named_steps["cat_encoder"] # old solution</span></span><br><span class="line">cat_encoder = full_pipeline.named_transformers_[<span class="string">"cat"</span>]</span><br><span class="line">cat_one_hot_attribs = list(cat_encoder.categories_[<span class="number">0</span>])</span><br><span class="line">attributes = num_attribs + extra_attribs + cat_one_hot_attribs</span><br><span class="line">sorted(zip(feature_importances, attributes), reverse=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[(<span class="number">0.3661589806181342</span>, <span class="string">'median_income'</span>),</span><br><span class="line"> (<span class="number">0.1647809935615905</span>, <span class="string">'INLAND'</span>),</span><br><span class="line"> (<span class="number">0.10879295677551573</span>, <span class="string">'pop_per_hhold'</span>),</span><br><span class="line"> (<span class="number">0.07334423551601242</span>, <span class="string">'longitude'</span>),</span><br><span class="line"> (<span class="number">0.0629090704826203</span>, <span class="string">'latitude'</span>),</span><br><span class="line"> (<span class="number">0.05641917918195401</span>, <span class="string">'rooms_per_hhold'</span>),</span><br><span class="line"> (<span class="number">0.05335107734767581</span>, <span class="string">'bedrooms_per_room'</span>),</span><br><span class="line"> (<span class="number">0.041143798478729635</span>, <span class="string">'housing_median_age'</span>),</span><br><span class="line"> (<span class="number">0.014874280890402767</span>, <span class="string">'population'</span>),</span><br><span class="line"> (<span class="number">0.014672685420543237</span>, <span class="string">'total_rooms'</span>),</span><br><span class="line"> (<span class="number">0.014257599323407807</span>, <span class="string">'households'</span>),</span><br><span class="line"> (<span class="number">0.014106483453584102</span>, <span class="string">'total_bedrooms'</span>),</span><br><span class="line"> (<span class="number">0.010311488326303787</span>, <span class="string">'&lt;1H OCEAN'</span>),</span><br><span class="line"> (<span class="number">0.002856474637320158</span>, <span class="string">'NEAR OCEAN'</span>),</span><br><span class="line"> (<span class="number">0.00196041559947807</span>, <span class="string">'NEAR BAY'</span>),</span><br><span class="line"> (<span class="number">6.028038672736599e-05</span>, <span class="string">'ISLAND'</span>)]</span><br></pre></td></tr></table></figure>

<p>with these info we can decide which parameter to drop.</p>
<h4 id="Evaluate-Your-System-on-the-Test-Set"><a href="#Evaluate-Your-System-on-the-Test-Set" class="headerlink" title="Evaluate Your System on the Test Set"></a>Evaluate Your System on the Test Set</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">final_model = grid_search.best_estimator_</span><br><span class="line"></span><br><span class="line">X_test = strat_test_set.drop(<span class="string">"median_house_value"</span>, axis=<span class="number">1</span>)</span><br><span class="line">y_test = strat_test_set[<span class="string">"median_house_value"</span>].copy()</span><br><span class="line"></span><br><span class="line">X_test_prepared = full_pipeline.transform(X_test)</span><br><span class="line">final_predictions = final_model.predict(X_test_prepared)</span><br><span class="line"></span><br><span class="line">final_mse = mean_squared_error(y_test, final_predictions)</span><br><span class="line">final_rmse = np.sqrt(final_mse)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">final_rmse</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">47730.22690385927</span></span><br></pre></td></tr></table></figure>

<p>We can compute a 95% confidence interval for the test RMSE:</p>
<p>(A <strong>confidence interval</strong> gives an estimated range of values which is likely to include an unknown population parameter)</p>
<p><a href="http://www.stat.yale.edu/Courses/1997-98/101/confint.htm">http://www.stat.yale.edu/Courses/1997-98/101/confint.htm</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line">confidence = <span class="number">0.95</span></span><br><span class="line">squared_errors = (final_predictions - y_test) ** <span class="number">2</span></span><br><span class="line">mean = squared_errors.mean()</span><br><span class="line">m = len(squared_errors)</span><br><span class="line"></span><br><span class="line">np.sqrt(stats.t.interval(confidence, m - <span class="number">1</span>,</span><br><span class="line">                         loc=np.mean(squared_errors),</span><br><span class="line">                         scale=stats.sem(squared_errors)))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array([<span class="number">45685.10470776</span>, <span class="number">49691.25001878</span>])</span><br></pre></td></tr></table></figure>
























































        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/blog/tags/Chapter-2/" rel="tag">Chapter 2</a>, <a class="has-link-grey -link" href="/blog/tags/Hands-on-ML/" rel="tag">Hands on ML</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/blog/2019/06/03/Optimization%20for%20directory%20rendering%20in%20React/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Optimization for Directory Rendering in React</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/blog/2019/01/17/A%20structed%20light%20based%203d%20reconstruction%20using%20combined%20circular%20phase%20shifting%20patterns/">
                <span class="level-item">A structed light based 3d reconstruction using combined circular phase shifting patterns</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>


</div>
                




<div class="column is-4-tablet is-4-desktop is-4-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="is-rounded" src="/blog/images/17433616.jpeg" alt="Tony He">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Tony He
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Web Developer
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Toronto,ON</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Posts
                    </p>
                    <a href="/blog/archives">
                        <p class="title has-text-weight-normal">
                            14
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categories
                    </p>
                    <a href="/blog/categories">
                        <p class="title has-text-weight-normal">
                            9
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Tags
                    </p>
                    <a href="/blog/tags">
                        <p class="title has-text-weight-normal">
                            21
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/maolon" target="_blank" rel="noopener">
                Follow</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/maolon">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="RSS" href="/blog/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categories
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/blog/categories/Crawler/">
            <span class="level-start">
                <span class="level-item">Crawler</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/blog/categories/Crawler/Andriod/">
            <span class="level-start">
                <span class="level-item">Andriod</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/blog/categories/ML/">
            <span class="level-start">
                <span class="level-item">ML</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/blog/categories/NLP/">
            <span class="level-start">
                <span class="level-item">NLP</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/blog/categories/Seminar/">
            <span class="level-start">
                <span class="level-item">Seminar</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/blog/categories/WEB/">
            <span class="level-start">
                <span class="level-item">WEB</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/blog/categories/WEB/React/">
            <span class="level-start">
                <span class="level-item">React</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/blog/categories/Web/">
            <span class="level-start">
                <span class="level-item">Web</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/blog/categories/algorithm/">
            <span class="level-start">
                <span class="level-item">algorithm</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Tag Cloud
        </h3>
        <a href="/blog/tags/Array/" style="font-size: 10px;">Array</a> <a href="/blog/tags/Basic/" style="font-size: 10px;">Basic</a> <a href="/blog/tags/Chapter-2/" style="font-size: 10px;">Chapter 2</a> <a href="/blog/tags/DP/" style="font-size: 15px;">DP</a> <a href="/blog/tags/Greedy/" style="font-size: 10px;">Greedy</a> <a href="/blog/tags/Hands-on-ML/" style="font-size: 10px;">Hands on ML</a> <a href="/blog/tags/Jsoup/" style="font-size: 10px;">Jsoup</a> <a href="/blog/tags/LinearSearch/" style="font-size: 10px;">LinearSearch</a> <a href="/blog/tags/List/" style="font-size: 10px;">List</a> <a href="/blog/tags/Note/" style="font-size: 20px;">Note</a> <a href="/blog/tags/Performance-Optimization/" style="font-size: 10px;">Performance Optimization</a> <a href="/blog/tags/Recursive/" style="font-size: 10px;">Recursive</a> <a href="/blog/tags/Redux/" style="font-size: 15px;">Redux</a> <a href="/blog/tags/Seminar/" style="font-size: 10px;">Seminar</a> <a href="/blog/tags/Structured-Light/" style="font-size: 10px;">Structured Light</a> <a href="/blog/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/blog/tags/filter/" style="font-size: 10px;">filter</a> <a href="/blog/tags/java/" style="font-size: 15px;">java</a> <a href="/blog/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/blog/tags/ngram/" style="font-size: 10px;">ngram</a> <a href="/blog/tags/nodejs/" style="font-size: 10px;">nodejs</a>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archives
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2020/01/">
                <span class="level-start">
                    <span class="level-item">January 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/11/">
                <span class="level-start">
                    <span class="level-item">November 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">August 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">July 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/06/">
                <span class="level-start">
                    <span class="level-item">June 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">May 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/01/">
                <span class="level-start">
                    <span class="level-item">January 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">August 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">July 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">June 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Tags
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Array/">
                        <span class="tag">Array</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Basic/">
                        <span class="tag">Basic</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Chapter-2/">
                        <span class="tag">Chapter 2</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/DP/">
                        <span class="tag">DP</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Greedy/">
                        <span class="tag">Greedy</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Hands-on-ML/">
                        <span class="tag">Hands on ML</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Jsoup/">
                        <span class="tag">Jsoup</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/LinearSearch/">
                        <span class="tag">LinearSearch</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/List/">
                        <span class="tag">List</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Note/">
                        <span class="tag">Note</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Performance-Optimization/">
                        <span class="tag">Performance Optimization</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Recursive/">
                        <span class="tag">Recursive</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Redux/">
                        <span class="tag">Redux</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Seminar/">
                        <span class="tag">Seminar</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Structured-Light/">
                        <span class="tag">Structured Light</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/TCP/">
                        <span class="tag">TCP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/filter/">
                        <span class="tag">filter</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/java/">
                        <span class="tag">java</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/javascript/">
                        <span class="tag">javascript</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/ngram/">
                        <span class="tag">ngram</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/nodejs/">
                        <span class="tag">nodejs</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/blog/">
                
                    <img src="/blog/images/logo.png" alt="Hands On ML" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 Tony He&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/maolon">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'http://yoursite.com/blog',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/blog/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/blog/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/blog/js/back-to-top.js" defer></script>














<script src="/blog/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/blog/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/blog/js/insight.js" defer></script>
<link rel="stylesheet" href="/blog/css/search.css">
<link rel="stylesheet" href="/blog/css/insight.css">
    
</body>
</html>